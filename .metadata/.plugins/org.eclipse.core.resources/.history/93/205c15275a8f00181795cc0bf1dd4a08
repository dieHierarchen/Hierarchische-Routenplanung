import java.util.ArrayList;

import org.xml.sax.helpers.AttributesImpl;


public class XmlEdgeParser extends XmlNodeParser{

	public XmlEdgeParser(Graph graph) {
		super(graph);
	}
	
	@Override
	class ElementContent{
		private String qName;
		private AttributesImpl attributes;
		private ArrayList<ElementContent> children = new ArrayList<ElementContent>();
		
		public ElementContent(String qName, AttributesImpl attributes) {
			this.qName = qName;
			this.attributes = attributes;
		}
		
		public void addChild(ElementContent element) {
			children.add(element);
		}
		
		public AttributePair getAttributePair() {
			String key = "";
			String value = "";
			for(int i = 0; i<attributes.getLength(); i++) {
				if(attributes.getQName(i) == "k") {
					key = attributes.getValue(i);
				}else if (attributes.getQName(i) == "v") {
					value = attributes.getValue(i);
				}
			}
			return new AttributePair(key,value);
		}
		
		public void elementIsReady() {
			int locationCode = 0;
			int nextLocation = 0;
			for(ElementContent child:children) {
				AttributePair pair = child.getAttributePair();
				if (pair.key.contains("LocationCode")) {
					locationCode = Integer.parseInt(pair.value);
				} else if (pair.key.contains("NextLocationCode")) {
					nextLocation = Integer.parseInt(pair.value);
				}
			}

			if(locationCode != 0 && nextLocation != 0) {
				graph.addEdge(locationCode, nextLocation);
			}
			
		}
	}
}
